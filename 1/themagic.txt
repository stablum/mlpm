N = X.shape[1]
 
a = dot(W,X)
z = activation_function(a)
xp = dot(W.T, a)



average_dW = (N*W + dot(z,xp.T)) / N
w += learning_rate * average_dW